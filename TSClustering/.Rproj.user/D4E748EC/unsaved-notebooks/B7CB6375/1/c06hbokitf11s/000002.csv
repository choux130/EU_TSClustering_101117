"0","#### Packages ####"
"0","library(tidyverse)"
"0","library(ggplot2)"
"0","#### Import multiple dataframe ####"
"0","d_JOUT_edited = read.csv('RawData/JOUT_edit.csv', header = TRUE)"
"0","d_JOUT_edited$Date = as.Date(d_JOUT_edited$Date, ""%m/%d/%y"")"
"0","write.csv(d_JOUT_edited, 'RawData/JOUT_edited.csv', row.names=FALSE)"
"0","temp = list.files(path = ""RawData"", pattern=""*.csv"")"
"0","temp = temp[-which(temp %in% c('JOUT.csv', 'JOUT_edit.csv', 'SP500IndexData.csv'))]"
"0","myfiles = lapply(temp, function(x) read.csv(paste(""RawData"", x, sep=""/""), header=TRUE))"
"0","name = sapply(temp, function(x) unlist(strsplit(x[1], split='.', fixed=TRUE))[1])"
"0","names(myfiles) = name"
"0","# max(unlist(lapply(myfiles, function(x) dim(x)[1])))"
"0","# 14032"
"0","#### Add price as the mean of c(""Open"", ""High"", ""Low"", ""Close"") ####"
"0","newfiles = lapply(myfiles, function(df) {"
"0","  cbind(df, price = apply(df[c(""Open"", ""High"", ""Low"", ""Close"")], 1, mean))"
"0","})"
"0","newfiles = lapply(newfiles, function(df) df[which(names(df) %in% c('Date','price'))])"
"0","# change the name of 'price' column to the stock name"
"0","for (i in names(newfiles)){"
"0","  names(newfiles[[i]]) = c('Date', i)"
"0","}"
"0","#### The large dataset ####"
"0","d_all = Reduce(function(dtf1, dtf2) full_join(dtf1, dtf2), newfiles) # 14032    16"
"0","d_all$Date = as.Date(d_all$Date, ""%Y-%m-%d"")"
"0","d_all = d_all[order(d_all$Date),]"
"0","# the data is end on ""2017-09-26"""
"0","d_all = subset(d_all, Date < ""2017-09-27"")"
"0","#### The complete dataset ####"
"0","d_comp = subset(d_all, complete.cases(d_all)) #  4261   16"
"0","d_comp_long = gather(d_comp, key = stock, value = price, 2:16)"
"0","# min(d_comp$Date) # ""2000-10-18"""
"0","# max(d_comp$Date) # ""2017-09-26"""
"0","#### Normalized the complete dataset ####"
"0","d_comp_norm = d_comp"
"0","d_comp_norm[,2:16]= apply(d_comp[,2:16], 2, scale)"
"0","d_comp_norm_long = gather(d_comp_norm, key = stock, value = price, 2:16)"
